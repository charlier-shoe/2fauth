"use strict";function AnalyticsEvent(a){this.name=a,this.timestamp=(new Date).toISOString(),this.sessionID=null,delete this.sessionID,this.properties={}}function Analytics(a){this.backend=a,this.sessionID=null,this._events=[],this.getSessionId=function(){return this.sessionID},this.startSession=function(){null==this.sessionID&&(this.sessionID=mcs._Utils.uuid(),this.logNamedEvent("sessionStart").type="system")},this.endSession=function(a,b){null!=this.sessionID&&(this.logNamedEvent("sessionEnd").type="system",mcs._Logger.log("Deactivate a default session"),this.flush(a,b),this.sessionID=null)},this.logNamedEvent=function(a){var b=new mcs.AnalyticsEvent(a);return this.logEvent(b),b},this.logEvent=function(a){return 0==this._events.length&&(this._events[0]=this._createContextEvent()),this.startSession(),this._events[this._events.length]=a,a.sessionID=this.sessionID,a},this.flush=function(a,b){for(var c=0;c<this._events.length;c++)if("context"==this._events[c].name){var d=mcs.MobileBackendManager.platform.getGPSLocation();null!=d&&null!=d.latitude&&(this._events[c].properties.latitude=d.latitude),null!=d&&null!=d.longitude&&(this._events[c].properties.longitude=d.longitude)}var e=JSON.stringify(this._events),f=this,g=f.backend.getHttpHeaders();g["Content-Type"]="application/json",mcs.MobileBackendManager.platform.invokeService({method:"POST",url:f.backend.getPlatformUrl("analytics/events"),headers:g,body:e,success:function(){mcs._Logger.log("Analytics events flushed."),f._events=[],null!=a&&a()},error:function(a,c){mcs._Logger.log("Failed to flush analytics events."),null!=b&&b(a,c)}})},this._createContextEvent=function(){var a=new mcs.AnalyticsEvent("context");a.type="system",a.properties.timezone=""+60*(new Date).getTimezoneOffset();var b=mcs.MobileBackendManager.platform.getDeviceInformation();return a.properties.model=b.model,a.properties.manufacturer=b.manufacturer,a.properties.osName=b.osName,a.properties.osVersion=b.osVersion,a.properties.osBuild=b.osBuild,a.properties.carrier=b.carrier,a}}function Authorization(a,b,c){this.AuthenticationType=c,this.backend=b,this.config=a,this._accessToken=null,this.authorizedUserName=null;var d=this;this.authenticateAnonymous=function(a,b){},this.authenticate=function(a,b,c,d){},this.isAuthorized=function(){return null!=this._accessToken},this.isTokenValid=function(){return null!=this._accessToken},this.refreshToken=function(a,b){},this.logout=function(){this._accessToken=null,this.authorizedUserName=null},this.getCurrentUser=function(a,b){mcs.MobileBackendManager.platform.invokeService({method:"GET",url:d.backend.getPlatformUrl("users/~"),headers:d.backend.getHttpHeaders(),success:function(b,c){if(null!=a){var d=new mcs.User(c);null!=d.links&&delete d.links,a(b.status,d)}},error:function(a,c){null!=b&&b(a,c)}})},this._getHttpHeaders=function(a){}}function BasicAuthorization(a,b,c){function d(){n.setAccessToken(null),n.setAnonymousAccessToken(null),n.setIsAuthorized(!1),n.setIsAnonymous(!1),n.authorizedUserName=null}Authorization.call(this,a,b,mcs.AuthorizationTypeBasic);var e=mcs._Utils.validateConfiguration(a.backendId),f=mcs._Utils.validateConfiguration(a.anonymousToken),g=mcs._Utils.validateConfiguration(c),h="Authorization",i="Oracle-Mobile-Backend-Id",j="Oracle-Mobile-Application-Key",k=null,l=!1,m=!1,n=this;this.getAnonymousToken=function(){return f},this.getApplicationKey=function(){return g},this.getBackendId=function(){return e},this.getAccessToken=function(){return this._accessToken},this.setAccessToken=function(a){this._accessToken=a},this.getAnonymousAccessToken=function(){return k},this.setAnonymousAccessToken=function(a){k=a},this.getIsAuthorized=function(){return l},this.setIsAuthorized=function(a){l=a},this.getIsAnonymous=function(){return m},this.setIsAnonymous=function(a){m=a},this.backend=b,this.authenticate=function(a,b,c,e){if(n.logout(),!a||!b)return mcs._Logger.log(mcs.logLevelError,"Wrong username or password parameter"),void(e&&e(400,"Bad Request"));var f="Basic "+mcs._Utils.encodeBase64(a+":"+b);mcs.MobileBackendManager.platform.invokeService({url:n.backend.getPlatformUrl("users/login"),method:"GET",headers:{Authorization:f,"Oracle-Mobile-Backend-Id":n.getBackendId(),"Oracle-Mobile-Application-Key":n.getApplicationKey()},success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"User "+a+" logged in"),n.setIsAuthorized(!0),n.setIsAnonymous(!1),n.setAccessToken(f),n.authorizedUserName=a,null!=c&&c(b.status,d)},error:function(a,b){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),d(),null!=e&&e(a,b)}})},this.authenticateAnonymous=function(a,b){n.logout();var c="Basic "+n.getAnonymousToken();mcs.MobileBackendManager.platform.invokeService({url:n.backend.getPlatformUrl("users/login"),method:"GET",headers:{Authorization:c,"Oracle-Mobile-Backend-Id":n.getBackendId(),"Oracle-Mobile-Application-Key":n.getApplicationKey()},success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"User logged in anonymously "+b.status),n.setIsAuthorized(!0),n.setIsAnonymous(!0),n.setAnonymousAccessToken(c),null!=a&&a(b.status,d)},error:function(a,c){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),d(),null!=b&&b(a,c)}})},this.isTokenValid=function(){return null!==n.getAccessToken()&&"string"==typeof n.getAccessToken()?(mcs._Logger.log(mcs.logLevelInfo,"Authorization token is not null or empty"),!0):null==n.getAccessToken()&&"string"!=typeof n.getAccessToken()?(mcs._Logger.log(mcs.logLevelInfo,"Authorization token is null and/or empty"),!1):void 0},this.refreshToken=function(a,b){var c=n.isTokenValid();0==n.getIsAuthorized()&&c!==!0?null!==b&&b(401,"Please use the authenticate with username/password combination or authenticateAnonymous function before using refreshToken."):1==n.getIsAuthorized()&&1==c&&null!==a&&(mcs._Logger.log(mcs.logLevelError,"Authenticated token is valid, you do not need to refresh."),a(200,n.getAccessToken()))},this.logout=function(){n.authorizedUserName=null,n.setAccessToken(null),n.setAnonymousAccessToken(null),n.setIsAuthorized(!1),n.setIsAnonymous(!1)},this._getHttpHeaders=function(a){null!==n.getAccessToken()&&"string"==typeof n.getAccessToken()&&(a[h]=n.getAccessToken()),a[i]=n.getBackendId(),a[j]=n.getApplicationKey()},this._getAnonymousHttpHeaders=function(a){null!==n.getAnonymousAccessToken()&&"string"==typeof n.getAnonymousAccessToken()&&(a[h]=n.getAnonymousAccessToken()),a[i]=n.getBackendId(),a[j]=n.getApplicationKey()}}function OAuthAuthorization(a,b,c){Authorization.call(this,a,b,mcs.AuthenticationTypeOAuth);var d=mcs._Utils.validateConfiguration(a.clientId),e=mcs._Utils.validateConfiguration(a.clientSecret),f=mcs._Utils.validateConfiguration(c);if(a.hasOwnProperty("userIdentityDomainName"))var g=mcs._Utils.validateConfiguration(a.userIdentityDomainName);var h="Authorization",i="X-USER-IDENTITY-DOMAIN-NAME",j="Oracle-Mobile-Application-Key",k=null,l=null,m=!1,n=!1,o=this;this.backend=b,this.getClientId=function(){return d},this.getApplicationKey=function(){return f},this.getTenantName=function(){return g},this.getClientSecret=function(){return e},this.getAccessToken=function(){return this._accessToken},this.setAccessToken=function(a){this._accessToken=a},this.getAnonymousAccessToken=function(){return k},this.setAnonymousAccessToken=function(a){k=a},this.getIsAuthorized=function(){return m},this.setIsAuthorized=function(a){m=a},this.getIsAnonymous=function(){return n},this.setIsAnonymous=function(a){n=a},this.authenticate=function(a,b,c,d){if(o.logout(),!a||!b)return mcs._Logger.log(mcs.logLevelError,"Wrong username or password parameter"),void(d&&d(400,"Bad Request"));var e="Basic "+mcs._Utils.encodeBase64(o.getClientId()+":"+o.getClientSecret()),f=q(a,b),g={};g["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",g[h]=e,g[j]=o.getApplicationKey(),"undefined"!=typeof o.getTenantName()&&(g[i]=o.getTenantName()),mcs.MobileBackendManager.platform.invokeService({url:o.backend.getOAuthTokenUrl(),method:"POST",headers:g,body:f,success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"OAuth Token received and time before it expires in seconds"),o.setIsAnonymous(!0),o.setIsAuthorized(!1),o.authorizedUserName=a,o.setAccessToken(d.access_token),null!=c&&c(b.status,d)},error:function(a,b){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),p(),null!=d&&d(a,b)}})},this.authenticateAnonymous=function(a,b){o.logout();var c="Basic "+mcs._Utils.encodeBase64(o.getClientId()+":"+o.getClientSecret()),d={};d["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",d[h]=c,d[j]=o.getApplicationKey(),"undefined"!=typeof o.getTenantName()&&(d[i]=o.getTenantName()),mcs.MobileBackendManager.platform.invokeService({url:o.backend.getOAuthTokenUrl(),method:"POST",headers:d,body:"grant_type=client_credentials",success:function(b,c){mcs._Logger.log(mcs.logLevelInfo,"OAuth Token received and time before it expires in seconds"),o.setIsAnonymous(!0),o.setIsAuthorized(!0),o.setAnonymousAccessToken(c.access_token),l=Date.now()+1e3*c.expires_in,null!=a&&a(b.status,c)},error:function(a,c){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),p(),null!=b&&b(a,c)}})},this.isTokenValid=function(){null===o.getAccessToken()&&null===o.getAnonymousAccessToken()||mcs._Logger.log(mcs.logLevelVerbose,"OAuth Token is not null or empty");var a=Date.now();return a>=l?(mcs._Logger.log(mcs.logLevelInfo,"Token has expired"),!1):(mcs._Logger.log(mcs.logLevelVerbose,"Token is still valid"),!0)},this.logout=function(){o.authorizedUserName=null,o.setIsAnonymous(!1),o.setIsAuthorized(!1),o.setAccessToken(null),o.setAnonymousAccessToken(null),l=1e3*Date.now()},this.refreshToken=function(a,b){var c=o.isTokenValid();c!==!1?(null==o.getAccessToken()&&o.getIsAnonymous()!==!1&&null!=a&&(mcs._Logger.log(mcs.logLevelError,"Anonymous token is valid, you do not need to refresh."),a(200,o.getAnonymousAccessToken())),null==o.getAnonymousAccessToken()&&o.getIsAnonymous()!==!0&&null!=a&&(mcs._Logger.log(mcs.logLevelError,"Authenticated token is valid, you do not need to refresh."),a(200,o.getAccessToken()))):(mcs._Logger.log(mcs.logLevelError,"Token has expired or user has not been authenticate with the service."),null!=b&&b(401,"Please use the authenticate with username/password combination or authenticateAnonymous function before using refreshToken."))};var p=function(){o.authorizedUserName=null,o.setIsAnonymous(!1),o.setIsAuthorized(!1),o.setAccessToken(null),o.setAnonymousAccessToken(null),l=1e3*Date.now()},q=function(a,b){var c,d;return c=a.indexOf("@")>-1?encodeURIComponent(a).replace(/%20/g,"+"):encodeURIComponent(a).replace(/%5B/g,"[").replace(/%5D/g,"]"),d=b.indexOf("&")>-1?encodeURIComponent(b).replace(/%20/g,"+"):encodeURIComponent(b).replace(/%5B/g,"[").replace(/%5D/g,"]"),"grant_type=password&username="+c+"&password="+d};this._getHttpHeaders=function(a){null!==o.getAccessToken()&&"string"==typeof o.getAccessToken()&&(a[h]="Bearer "+o.getAccessToken()),a[j]=o.getApplicationKey()},this._getAnonymousHttpHeaders=function(a){null!==o.getAnonymousAccessToken()&&"string"==typeof o.getAnonymousAccessToken()&&(a[h]="Bearer "+o.getAnonymousAccessToken()),a[j]=o.getApplicationKey()}}function User(a){var b=a.id,c=a.username,d=a.firstName,e=a.lastName,f=a.email,g={};for(var h in a)["id","username","firstName","lastName","email"].indexOf(h)<0&&(g[h]=a[h]),null!=g.links&&delete g.links;this.getId=function(){return b},this.getUsername=function(){return c},this.setUsername=function(a){c=a},this.getProperties=function(){return g},this.setProperties=function(a,b){var c=this.getProperties(),d=a.split(/\./);d.length<2?c[d[0]]=b:(c[d[0]]||(c[d[0]]={}),c=c[d.shift()],this.setProperties(d.join("."),b))},this.getFirstName=function(){return d},this.setFirstName=function(a){d=a},this.getLastName=function(){return e},this.setLastName=function(a){e=a},this.getEmail=function(){return f},this.setEmail=function(a){f=a}}function Diagnostics(a){this.backend=a,this._sessionId=mcs._Utils.uuid(),this._getHttpHeaders=function(a){a["Oracle-Mobile-DIAGNOSTIC-SESSION-ID"]=this.getSessionId(),a["Oracle-Mobile-DEVICE-ID"]=mcs.MobileBackendManager.platform.getDeviceId(),a["Oracle-Mobile-CLIENT-REQUEST-TIME"]=(new Date).toISOString()},this.getSessionId=function(){return this._sessionId}}function StorageObject(a,b){function c(a,b,c,d){null!=d&&(c.setPayload(b),c.name=decodeURI(a.getResponseHeader("Oracle-Mobile-Name")),c._eTag=a.getResponseHeader("ETag"),c.contentLength=b.size,c.contentType=a.getResponseHeader("Content-Type"),c.createdBy=a.getResponseHeader("Oracle-Mobile-Created-By"),c.createdOn=a.getResponseHeader("Oracle-Mobile-Created-On"),c.modifiedBy=a.getResponseHeader("Oracle-Mobile-Modified-By"),c.modifiedOn=a.getResponseHeader("Oracle-Mobile-Modified-On"),d(c))}function d(a,b,c){null!=c&&c(a,b)}var e=a,f=null;null!=b&&(this.id=b.id,this.name=b.name,this.contentLength=b.contentLength,this.contentType=b.contentType,this._eTag=b.eTag,this.createdBy=b.createdBy,this.createdOn=b.createdOn,this.modifiedBy=b.modifiedBy,this.modifiedOn=b.modifiedOn),this.getPayload=function(){return f},this.setPayload=function(a){f=a},this.getstorageCollection=function(){return e},this.getStorage=function(){return this.getstorageCollection()._storage},this.loadPayload=function(a,b){f=a,this.contentType=b,"text/plain"==this.contentType?"string"==typeof f&&(f=a):"application/json"==this.contentType&&("string"==typeof f?f=a:"object"==typeof f&&(f=JSON.stringify(a))),this.contentLength=f.length},this.setDisplayName=function(a){this.name=a},this.getDisplayName=function(){return this.name},this.readPayload=function(a,b,e){if(null==this.getPayload()){var f=this,g=f.getstorageCollection().getStorage().backend.getHttpHeaders(),h="storage/collections/"+f.getstorageCollection().id+"/objects/"+this.id;null!=f.getstorageCollection().userId&&f.getstorageCollection()._userIsolated&&(h+="?user="+f.getstorageCollection().userId),mcs.MobileBackendManager.platform.invokeService({method:"GET",url:f.getstorageCollection().getStorage().backend.getPlatformUrl(h),headers:g,responseType:e||"blob",success:function(b,d){c(b,d,f,a)},error:function(a,c){d(a,c,b)}})}}}function StorageCollection(a,b,c){var d=c,e=mcs._Utils.validateConfiguration(b),f=a,g=this;this.getStorage=function(){return d},this.getUserId=function(){return e},this.getData=function(){return f},this.id=this.getData().id,this.description=this.getData().description,this._userIsolated=this.getData().userIsolated,this.getObjects=function(a,b,c,d){var e=g.getStorage().backend.getHttpHeaders();e.Accept="application/json";var f="storage/collections/"+g.id+"/objects";null!=a&&(f+=f.indexOf("?")==-1?"?":"&",f+="offset="+a),null!=b&&(f+=f.indexOf("?")==-1?"?":"&",f+="limit="+b),null!=g.getUserId()&&g._userIsolated&&(f+=f.indexOf("?")==-1?"?":"&",f+="user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"GET",url:g.getStorage().backend.getPlatformUrl(f),headers:e,success:function(a,b){if(null!=c){for(var d=[],e=b,f=0;f<e.items.length;f++)d[d.length]=new mcs.StorageObject(g,e.items[f]);c(d)}},error:function(a,b){null!=d&&d(a,b)}})},this.getObject=function(a,b,c,d){var e=new mcs.StorageObject(this);e.id=a,e.readPayload(function(a){null!=b&&b(e)},function(a,b){null!=c&&c(a,b)},d)},this.postObject=function(a,b,c){this._postOrPutStorageObject(a,!0,b,c)},this.putObject=function(a,b,c){this._postOrPutStorageObject(a,!1,b,c)},this._postOrPutStorageObject=function(a,b,c,d){var e=g.getStorage().backend.getHttpHeaders();e["Oracle-Mobile-Name"]=encodeURI(a.getDisplayName()),e["Content-Type"]=a.contentType;var f="storage/collections/"+g.id+"/objects";b||(f+="/"+a.id,null!=a._eTag&&(e["If-Match"]=a._eTag)),g._userIsolated&&null!=g.getUserId()&&(f+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:b?"POST":"PUT",url:g.getStorage().backend.getPlatformUrl(f),headers:e,body:a.getPayload(),success:function(a,b){if(null!=c){var d=new mcs.StorageObject(g,b);c(a.status,d)}},error:function(a,b){null!=d&&d(a,b)}})},this.contains=function(a,b,c){var d=g.getStorage().backend.getHttpHeaders(),e="storage/collections/"+g.id+"/objects/"+a;g._userIsolated&&null!=g.getUserId()&&(e+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"HEAD",url:g.getStorage().backend.getPlatformUrl(e),headers:d,success:function(a,c){null!=b&&b(a.status,c)},error:function(a,b){null!=c&&c(a,b)}})},this.deleteObject=function(a,b,c){var d=g.getStorage().backend.getHttpHeaders();d["If-Match"]="*";var e="storage/collections/"+g.id+"/objects/"+a;g._userIsolated&&null!=g.getUserId()&&(e+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"DELETE",url:g.getStorage().backend.getPlatformUrl(e),headers:d,success:function(a,c){null!=b&&b(a.status,c)},error:function(a,b){null!=c&&c(a,b)}})}}function Storage(a){this.backend=a;var b=this;this.getCollection=function(a,c,d,e){var f=b.backend.getHttpHeaders();f.Accept="application/json",mcs.MobileBackendManager.platform.invokeService({method:"GET",url:b.backend.getPlatformUrl("storage/collections/"+mcs._Utils.validateConfiguration(a)),headers:f,success:function(a,e){null!=d&&d(new mcs._StorageCollection(e,mcs._Utils.validateConfiguration(c),b))},error:function(a,b){null!=e&&e(a,b)}})}}!function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Logger=a.mcs._Logger||{}}(),mcs.logLevelError=1,mcs.logLevelInfo=2,mcs.logLevelVerbose=3,mcs._Logger.logLevel=mcs.logLevelInfo,mcs._Logger.Exception=function(a){this.message=a,this.name="Exception",console.log(this.name+" : "+this.message)},mcs._Logger.debug=function(a,b){console.log(a+" "+b)},mcs._Logger.log=function(a,b){mcs._Logger.logLevel>=a&&console.log(b)},function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Utils=a.mcs._Utils||{}}();var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";mcs._Utils.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},mcs._Utils.validateConfiguration=function(a){var b=a;return/\s/.test(b)&&void 0!=b&&(b=removeSpace(a)),b};var removeSpace=function(a){return a.replace(/ /g,"")};mcs._Utils.encodeBase64=function(a){var b,c,d,e,f,g="",h="",i="",j=0;do b=a.charCodeAt(j++),c=a.charCodeAt(j++),h=a.charCodeAt(j++),d=b>>2,e=(3&b)<<4|c>>4,f=(15&c)<<2|h>>6,i=63&h,isNaN(c)?f=i=64:isNaN(h)&&(i=64),g=g+keyStr.charAt(d)+keyStr.charAt(e)+keyStr.charAt(f)+keyStr.charAt(i),b=c=h="",d=e=f=i="";while(j<a.length);return g},mcs._Utils.decodeBase64=function(a){var b,c,d,e,f,g="",h="",i="",j=0,k=/[^A-Za-z0-9\+\/\=]/g;if(k.exec(a))return null;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=keyStr.indexOf(a.charAt(j++)),e=keyStr.indexOf(a.charAt(j++)),f=keyStr.indexOf(a.charAt(j++)),i=keyStr.indexOf(a.charAt(j++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,h=(3&f)<<6|i,g+=String.fromCharCode(b),64!=f&&(g+=String.fromCharCode(c)),64!=i&&(g+=String.fromCharCode(h)),b=c=h="",d=e=f=i="";while(j<a.length);return g},mcs._Utils.hasValue=function(a,b,c){return a.hasOwnProperty(b)&&a[b]===c},mcs._Utils.isEquivalentURL=function(a,b){return 0===a.indexOf("https")&&0===b.indexOf("https")?(a=443===mcs._Utils.getPort(a)?a.replace(":443",""):a,b=443===mcs._Utils.getPort(b)?b.replace(":443",""):b):a.indexOf("https")===-1&&b.indexOf("https")===-1&&(a=80===mcs._Utils.getPort(a)?a.replace(":80",""):a,b=80===mcs._Utils.getPort(b)?b.replace(":80",""):b),0===a.indexOf(b)},mcs._Utils.getPort=function(a){var b=a.indexOf(":",7),c=a.indexOf("/",b);b>0&&c==-1&&(c=a.length);var d=a.substr(b+1,c-b-1);return d&&!isNaN(1*d)?1*d:-1};var _deviceId=mcs._Utils.uuid(),Platform=function(){this.invokeService=function(a){throw mcs._Logger.Exception("invokeService() not implemented in Platform!")},this.getDeviceId=function(){return _deviceId},this.getGPSLocation=function(){return{latitude:null,longitude:null}},this.getDeviceInformation=function(){return{model:"<unknown>",manufacturer:"<unknown>",osName:"<unknown>",osVersion:"<unknown>",osBuild:"<unknown>",carrier:"<unknown>"}},this._deviceState=mcs.DeviceState.unrestricted,this._deviceStateChangedCallbacks=[],this.setDeviceState=function(a){if(this._deviceState!=a){mcs._Logger.log(mcs.logLevelInfo,"Device state changing from "+this._deviceState+" to "+a),this._deviceState=a;for(var b=0;b<this._deviceStateChangedCallbacks.length;b++)this._deviceStateChangedCallbacks[b](this._deviceState)}},this.cacheCredentials=function(a,b){},this.validateCachedCredentials=function(a,b){return!1}};!function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.Platform=Platform;var b=a.mcs;b.DeviceState={offline:0,unrestricted:1,restricted:2,critical:3}}(),function(a){function b(a){var b={};if(!a)return b;for(var c=a.split("\r\n"),d=0,e=c.length;d<e;d++){var f=c[d],g=f.indexOf(": ");g>0&&(b[f.substring(0,g)]=f.substring(g+2))}return b}var c=function(){this.isBrowser=!0,this.isCordova=!1,this.invokeService=function(c){function d(a,b){e(a,b)}function e(b,d){var e=new XMLHttpRequest;e.open(c.method,c.url);for(var f in c.headers)c.headers.hasOwnProperty(f)&&e.setRequestHeader(f,c.headers[f]);e.withCredentials=!0,e.responseType=c.responseType||"json",e.onreadystatechange=function(){if(4===e.readyState)if(e.status>=200&&e.status<=299){var c=""==e.responseType||"text"==e.responseType?e.responseText:e.response,f=e.responseHeaders||Persistence.Utils.parseResponseHeaders(e.getAllResponseHeaders());b({status:e.status,headers:f,data:c})}else d(new a.ErrorResponse(e.status,e.response,e.getAllResponseHeaders()))},e.send(c.data)}function f(a){var c=new XMLHttpRequest;c.open(a.method,a.url);for(var d in a.headers)a.headers.hasOwnProperty(d)&&c.setRequestHeader(d,a.headers[d]);c.withCredentials=!0,c.responseType=a.responseType||"json",c.onreadystatechange=function(){if(4===c.readyState){var d=!c.responseType||""!=c.responseType&&"text"!=c.responseType?c.response:c.responseText;if(this.status>=200&&this.status<=299){if(null!=a.success){var e=c.responseHeaders||b(c.getAllResponseHeaders()),f=d;"string"==typeof d&&(f=""==d?{}:JSON.parse(d)),a.success(c,f,e)}}else null!=a.error&&a.error(c.status,d)}},c.send(a.body)}return c.success||c.error?void f(c):new Promise(d)}};c.prototype=new a.Platform,a.BrowserPlatform=c}(("undefined"!=typeof window?window.mcs:global.mcs)||{}),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.AnalyticsEvent=AnalyticsEvent}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Analytics=Analytics}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.Authorization=Authorization,a.mcs.AuthenticationTypeBasic="basicAuth",a.mcs.AuthenticationTypeOAuth="oAuth",a.mcs.AuthenticationTypeSSO="ssoAuth",a.mcs.AuthenticationTypeFacebook="facebookAuth"}(),function(){BasicAuthorization.prototype=new mcs.Authorization;var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._BasicAuthorization=BasicAuthorization}(),function(){OAuthAuthorization.prototype=new mcs.Authorization;var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._OAuthAuthorization=OAuthAuthorization}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.User=User}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Diagnostics=Diagnostics}(),function(a){function b(b){this.backend=b;var d=this;this.invokeCustomCodeJSONRequest=function(b,e,f,g,h){if(e in c){var i=d.backend.getHttpHeaders();i["Content-Type"]="application/json";var j=f?JSON.stringify(f):null;a.MobileBackendManager.platform.invokeService({method:e,url:d.backend.getCustomCodeUrl(b),headers:i,body:j,success:function(a,b,c){null!=g&&g(a.status,b,c)},error:function(a,b){null!=h&&h(a,b)}})}else null!=h&&h(501,"Method Not Implemented")}}var c={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"};a.CustomCode=b}(("undefined"!=typeof window?window.mcs:global.mcs)||{}),function(a){function b(b,c){function d(a,b){return a.match(b+"$")==b}var e="mobile/platform",f="mobile/custom",g=null,h=this;this.name=b,this._config=c,this.getBaseUrl=function(){return a._Utils.validateConfiguration(this._config.baseUrl)},this.getAuthenticationTypeVariable=function(){return g},this.setAuthenticationTypeVariable=function(a){g=a},this.getPlatformUrl=function(b){var c=this._config.baseUrl;return"ssoAuth"==h.getAuthenticationTypeVariable()&&d(this._config.baseUrl,"1")&&(c=c.substring(0,c.length-4)+"7777"),c=a._Utils.validateConfiguration(c)+"/"+e,d(c,"/")||(c+="/"),c+b},this.getCustomCodeUri=function(a){var b="/"+f;return d(a,"/")&&(a=a.slice(0,-1)),b+"/"+a},this.getCustomCodeUrl=function(b){return a._Utils.validateConfiguration(this._config.baseUrl)+this.getCustomCodeUri(b)},this.getOAuthTokenUrl=function(){var b=a._Utils.validateConfiguration(this._config.authorization.oAuth.tokenEndpoint);return d(b,"/")||(b+="/"),b},this.getSSOAuthTokenUrl=function(){var b=a._Utils.validateConfiguration(this._config.authorization.ssoAuth.tokenEndpoint);return d(b,"/")||(b+="/"),b},this.getHttpHeaders=function(a){return null==a&&(a={}),this.Diagnostics._getHttpHeaders(a),this.Authorization.getIsAuthorized()!==!1&&this.Authorization.getIsAnonymous()!==!1?this.Authorization._getAnonymousHttpHeaders(a):this.Authorization._getHttpHeaders(a),a},this.setAuthenticationType=function(b){var c=a._Utils.validateConfiguration(b);if(this.Authorization=null,!this._config.authorization.hasOwnProperty(c))throw a._Logger.Exception("No Authentication Type called "+b+" is defined in MobileBackendManager.config \ncheck MobileBackendManager.config in authorization object for the following objects:\n"+a.AuthenticationTypeBasic+"\n"+a.AuthenticationTypeOAuth+"\n"+a.AuthenticationTypeFacebook+"\n"+a.AuthenticationTypeSSO);return null!==this.Authorization&&this.Authorization.getIsAuthorized()!==!1&&this.Authorization.logout(),c==a.AuthenticationTypeBasic?(this.Authorization=new a._BasicAuthorization(this._config.authorization.basicAuth,this,this._config.applicationKey),a._Logger.log(a.logLevelInfo,"Your Authentication type: "+c),h.setAuthenticationTypeVariable(c)):c==a.AuthenticationTypeOAuth?(this.Authorization=new a._OAuthAuthorization(this._config.authorization.oAuth,this,this._config.applicationKey),a._Logger.log(a.logLevelInfo,"Your Authentication type: "+c),h.setAuthenticationTypeVariable(c)):c==a.AuthenticationTypeFacebook?(this.Authorization=new a._FacebookAuthorization(this._config.authorization.facebookAuth,this,this._config.applicationKey),a._Logger.log(a.logLevelInfo,"Your Authentication type: "+c),h.setAuthenticationTypeVariable(c)):c==a.AuthenticationTypeSSO&&(this.Authorization=new a._SSOAuthorization(this._config.authorization.ssoAuth,this,this._config.applicationKey),a._Logger.log(a.logLevelInfo,"Your Authentication type: "+c),h.setAuthenticationTypeVariable(c)),this.Authorization},this.getAuthenticationType=function(){return this.Authorization},this.Diagnostics=new a._Diagnostics(this),this.CustomCode=new a.CustomCode(this),this.Analytics=new a._Analytics(this),this.Storage=new a._Storage(this),a._Synchronization&&(this.synchronization=new a._Synchronization(this,this._config.synchronization)),a._Notifications&&(this.Notifications=new a._Notifications(this)),this.AppConfig={},this.loadAppConfig=function(a,b){h.Authorization.isAuthorized()?h._loadAppConfig(a,b):h.Authorization.authenticateAnonymous(function(){h._loadAppConfig(a,b)},b)},this._loadAppConfig=function(b,c){var d=h.getHttpHeaders();d["Content-Type"]="application/json",a.MobileBackendManager.platform.invokeService({method:"GET",url:h.getPlatformUrl("appconfig/client"),headers:d,success:function(c,d){a._Logger.log(a.logLevelInfo,"New WebStarterApp config downloaded with status code: "+c.status),h.AppConfig=d,null!=b&&b(c.status,h.AppConfig)},error:function(b,d){a._Logger.log(a.logLevelError,"App config download failed! with status code: "+b),null!=c&&c(b,d)}})}}a._MobileBackend=b}(("undefined"!=typeof window?window.mcs:global.mcs)||{}),function(a){function b(b){if(!b.synchronization)return a._Logger.log(a.logLevelError,"WARNING, missing synchronization configuration, switch caching off"),void(Persistence.Options.off=!0);Persistence.Options.off=!1;var d={default:{conflictResolutionPolicy:"CLIENT_WINS",expirationPolicy:"NEVER_EXPIRE",expireAfter:600,evictionPolicy:"MANUAL_EVICTION",fetchPolicy:"FETCH_FROM_SERVICE_IF_ONLINE",updatePolicy:"QUEUE_IF_OFFLINE",noCache:!1},periodicRefreshInterval:b.synchronization.backgroundRefreshPolicy||120,policies:[]},e=b.synchronization.policies;for(var f in e)if(e.hasOwnProperty(f)){var g=e[f];g?d.policies.push(c(f,g)):a._Logger.log(a.logLevelError,"WARNING, the "+g+"policy was not found in accepted policies.")}Persistence.Options.Policies=d,Persistence.Options.dbFirst=!1,Persistence.Options.Module=Persistence.MCS,Persistence.Options.maxSyncAttempts=1,Persistence.Options.autoRemoveAfterReachMaxAttemps=!0}function c(b,c){var e={};e.path=b;for(var f in c){if(c.hasOwnProperty(f)){var g=d[f];e[g.persistencePropertyName]=g[c[f]]}void 0===e[g.persistencePropertyName]&&a._Logger.log(a.logLevelError,"WARNING, the "+f+" policy value "+c[f]+" was not found in accepted policy values.")}return e}var d={fetchPolicy:{persistencePropertyName:"fetchPolicy",FETCH_FROM_CACHE_SCHEDULE_REFRESH:"FETCH_FROM_CACHE_SCHEDULE_REFRESH",FETCH_FROM_SERVICE_IF_ONLINE:"FETCH_FROM_SERVICE_IF_ONLINE",FETCH_FROM_CACHE:"FETCH_FROM_CACHE",FETCH_FROM_SERVICE:"FETCH_FROM_SERVICE",FETCH_FROM_SERVICE_ON_CACHE_MISS:"FETCH_FROM_SERVICE_ON_CACHE_MISS",FETCH_FROM_SERVICE_ON_CACHE_MISS_OR_EXPIRY:"FETCH_FROM_SERVICE_ON_CACHE_MISS_OR_EXPIRY",FETCH_WITH_REFRESH:"FETCH_WITH_REFRESH"},evictionPolicy:{persistencePropertyName:"evictionPolicy",EVICT_ON_EXPIRY_AT_STARTUP:"EVICT_ON_EXPIRY_AT_STARTUP",MANUAL_EVICTION:"MANUAL_EVICTION"},expirationPolicy:{persistencePropertyName:"expirationPolicy",EXPIRE_ON_RESTART:"EXPIRE_ON_RESTART",EXPIRE_AFTER:"EXPIRE_AFTER",NEVER_EXPIRE:"NEVER_EXPIRE"},updatePolicy:{persistencePropertyName:"updatePolicy",QUEUE_IF_OFFLINE:"QUEUE_IF_OFFLINE",UPDATE_IF_ONLINE:"UPDATE_IF_ONLINE"},refreshPolicy:{persistencePropertyName:"refreshPolicy",PeriodicallyRefreshExpiredResource:""},conflictResolutionPolicy:{persistencePropertyName:"conflictResolutionPolicy",SERVER_WINS:"SERVER_WINS",PRESERVE_CONFLICT:"PRESERVE_CONFLICT",CLIENT_WINS:"CLIENT_WINS"},noCache:{persistencePropertyName:"noCache",false:!1,true:!0}},e={basicAuth:"basicAuth",oAuth:"oAuth",facebookAuth:"facebookAuth",ssoAuth:"ssoAuth"};a.MobileBackendManager=a.MobileBackendManager||{},a.MobileBackendManager.platform=new a.BrowserPlatform,a.MobileBackendManager._config={mobileBackends:{}},a.MobileBackendManager._mobileBackends={},a.MobileBackendManager.setConfig=function(c){null!=c.logLevel&&(a._Logger.logLevel=c.logLevel),this._config=c,this._mobileBackends={},"undefined"!=typeof Persistence&&b(c)},a.MobileBackendManager.returnMobileBackend=function(b,c){return 0==a.MobileBackendManager.platform.isCordova?a.MobileBackendManager.platform=new a.CordovaPlatform:a.MobileBackendManager.platform=new a.BrowserPlatform,a._Logger.log(a.logLevelInfo,"The Cordova platform is set!"),a.MobileBackendManager.setConfig(c),a._Logger.log(a.logLevelInfo,"The config has been set and now it has the backend defined in the config as the point of entry for the rest of the functions you need to call."),a.MobileBackendManager.getMobileBackend(b)},a.MobileBackendManager.getMobileBackend=function(b){if(null!=this._mobileBackends[b])return this._mobileBackends[b];for(var c in this._config.mobileBackends)if(c==a._Utils.validateConfiguration(b)){var d=new a._MobileBackend(b,this._config.mobileBackends[b]);return this._mobileBackends[b]=d,d}return a._Logger.log(a.logLevelError,"No mobile backend called "+b+" is defined in MobileBackendManager.config"),null},a.AUTHORIZATION_TYPES=e}(("undefined"!=typeof window?window.mcs:global.mcs)||{}),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},
a.mcs.StorageObject=StorageObject}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._StorageCollection=StorageCollection}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Storage=Storage}();